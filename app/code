
import java.util.ArrayList;
import java.util.Scanner;

public class TheExpensiveExpert {

  
    static ArrayList<Income> incomes = new ArrayList<>();
    static ArrayList<Expense> expenses = new ArrayList<>();

    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        int choice;

        do {
            System.out.println("\n====================================");
            System.out.println("        THE EXPENSIVE EXPERT");
            System.out.println("====================================");
            System.out.println("1. Add Income");
            System.out.println("2. Add Expense");
            System.out.println("3. View Savings");
            System.out.println("4. View Summary");
            System.out.println("5. View All Records");
            System.out.println("6. Delete Income");
            System.out.println("7. Delete Expense");
            System.out.println("8. Search Expense");
            System.out.println("9. Sort Expenses");
            System.out.println("10. Highest & Lowest Expense");
            System.out.println("11. Exit");
            System.out.print("Enter choice: ");

            choice = sc.nextInt();
            sc.nextLine();

            switch (choice) {
                case 1 -> addIncome(sc);
                case 2 -> addExpense(sc);
                case 3 -> viewSavings();
                case 4 -> viewSummary();
                case 5 -> viewRecords();
                case 6 -> deleteIncome(sc);
                case 7 -> deleteExpense(sc);
                case 8 -> searchExpense(sc);
                case 9 -> sortExpenses(sc);
                case 10 -> highestLowest();
                case 11 -> System.out.println("Exiting system...");
                default -> System.out.println("Invalid choice!");
            }

        } while (choice != 11);
    }

    
    public static void addIncome(Scanner sc) {
        System.out.print("Enter income amount: ");
        double amount = sc.nextDouble();

        if (amount > 0) {
            incomes.add(new Income(amount));
            System.out.println("Income added successfully!");
        } else {
            System.out.println("Invalid amount.");
        }
    }

    
    public static void addExpense(Scanner sc) {
        System.out.print("Enter expense name: ");
        String name = sc.nextLine();

        System.out.print("Enter amount: ");
        double amount = sc.nextDouble();

        if (amount > 0) {
            expenses.add(new Expense(name, amount));
            System.out.println("Expense added successfully!");
        } else {
            System.out.println("Invalid amount.");
        }
    }

    
    public static void viewSavings() {
        double totalIncome = getTotalIncome();
        double totalExpenses = getTotalExpense();

        System.out.println("\n----- SAVINGS -----");
        System.out.println("Total Income: PHP " + totalIncome);
        System.out.println("Total Expenses: PHP " + totalExpenses);
        System.out.println("Current Savings: PHP " + (totalIncome - totalExpenses));
    }

    
    public static void viewSummary() {
        System.out.println("\n----- SUMMARY -----");
        System.out.println("Income Entries: " + incomes.size());
        System.out.println("Expense Entries: " + expenses.size());
        System.out.println("Total Income: PHP " + getTotalIncome());
        System.out.println("Total Expenses: PHP " + getTotalExpense());
        System.out.println("Remaining Savings: PHP " + (getTotalIncome() - getTotalExpense()));
    }

    
    public static void viewRecords() {
        System.out.println("\n===== INCOMES =====");
        for (int i = 0; i < incomes.size(); i++) {
            System.out.print((i + 1) + ". ");
            incomes.get(i).display();
        }

        System.out.println("\n===== EXPENSES =====");
        for (int i = 0; i < expenses.size(); i++) {
            System.out.print((i + 1) + ". ");
            expenses.get(i).display();
        }
    }

    
    public static void deleteIncome(Scanner sc) {
        viewRecords();
        System.out.print("\nEnter income number to delete: ");
        int index = sc.nextInt() - 1;

        if (index >= 0 && index < incomes.size()) {
            incomes.remove(index);
            System.out.println("Income deleted!");
        } else {
            System.out.println("Invalid index.");
        }
    }

    
    public static void deleteExpense(Scanner sc) {
        viewRecords();
        System.out.print("\nEnter expense number to delete: ");
        int index = sc.nextInt() - 1;

        if (index >= 0 && index < expenses.size()) {
            expenses.remove(index);
            System.out.println("Expense deleted!");
        } else {
            System.out.println("Invalid index.");
        }
    }

    
    public static void searchExpense(Scanner sc) {
        System.out.print("Enter keyword: ");
        String key = sc.nextLine().toLowerCase();

        System.out.println("\n--- SEARCH RESULTS ---");
        boolean found = false;

        for (Expense e : expenses) {
            if (e.getName().toLowerCase().contains(key)) {
                e.display();
                found = true;
            }
        }

        if (!found) {
            System.out.println("No matching expenses found.");
        }
    }

    
    public static void sortExpenses(Scanner sc) {
        System.out.println("1. Ascending");
        System.out.println("2. Descending");
        System.out.print("Choose: ");
        int choice = sc.nextInt();

        expenses.sort((a, b) ->
                (choice == 1)
                        ? Double.compare(a.getAmount(), b.getAmount())
                        : Double.compare(b.getAmount(), a.getAmount())
        );

        System.out.println("Expenses sorted!");
    }

    
    public static void highestLowest() {
        if (expenses.isEmpty()) {
            System.out.println("No expenses recorded.");
            return;
        }

        Expense max = expenses.get(0);
        Expense min = expenses.get(0);

        for (Expense e : expenses) {
            if (e.getAmount() > max.getAmount()) max = e;
            if (e.getAmount() < min.getAmount()) min = e;
        }

        System.out.println("\n----- HIGHEST & LOWEST EXPENSE -----");
        System.out.print("Highest: ");
        max.display();
        System.out.print("Lowest: ");
        min.display();
    }

  
    public static double getTotalIncome() {
        double total = 0;
        for (Income i : incomes) total += i.getAmount();
        return total;
    }

    public static double getTotalExpense() {
        double total = 0;
        for (Expense e : expenses) total += e.getAmount();
        return total;
    }
}


